import java.io.*;
import java.util.*;
class Main{public static void main(String[] args)throws Exception{BufferedReader b=new BufferedReader(new InputStreamReader(System.in));StringTokenizer t=new StringTokenizer(b.readLine());int[] dy={-1,1,0,0},dx= {0,0,-1,1};char B[][]=new char[50][50];boolean V[][][]=new boolean[50][50][1<<6];int N=Integer.parseInt(t.nextToken()),M=Integer.parseInt(t.nextToken());Deque<I>q=new ArrayDeque<>();for(int i=0;i<N;i++) {String s=b.readLine();for(int j=0;j<M;j++){B[i][j]=s.charAt(j);if(B[i][j]=='0')q.offer(new I(i,j,0,0));}}while(!q.isEmpty()){I w=q.poll();if(B[w.y][w.x]=='1'){System.out.println(w.m);return;}for(int d=0;d<4;d++){int h=w.y+dy[d],g=w.x+dx[d];if(h<0||g<0||h>=N||g>=M||V[h][g][w.k]||B[h][g]=='#')continue;if(65<=B[h][g]&&B[h][g]<=70&&(w.k&(1<<(B[h][g]-65)))==0)continue;V[h][g][w.k]=true;if(97<=B[h][g]&&B[h][g]<=102)q.offer(new I(h,g,w.k|(1<<(B[h][g]-97)),w.m+1));else q.offer(new I(h,g,w.k,w.m+1));}}System.out.println(-1);}static class I{int y,x,k,m;I(int y,int x,int k,int m){this.y=y;this.x=x;this.k=k;this.m=m;}}}
